\section{MIP}
\subsection{Decision variables}
\subsubsection{match\_schedule}
For each $w \in W$ and $p \in P$, the binary
$$
match\_schedule_{w,p,m} = 1
$$
if, and only if, in week $w$ and period $p$ match $m \in M$ is played 

\subsubsection{flip\_slot}
For each week $w \in W$ and period $p \in P$  
$$  
flip\_slot_{w,p} = a \in \{0, 1\}  
$$  
determines which team from match $rb_{p, w} = (t_1, t_2)$ in week w and period p is assigned as the home team. Specifically, $a = 0$ means $t_1$ plays at home and $t_2$ away, while $a = 1$ means the assignment is reversed.

\subsubsection{team periods of play}
For each $t \in T$, $w \in W$ and $p \in P$, the binary
$$
TP_{t,w,p} = 1
$$
if, and only if, team t plays in week w and period p.

\subsubsection{home games counter}
For each team $t \in T$, the integer  
$$  
H_t = h \in [1, \dots, N-1]
$$  
determines the total number of home games assigned to team $t$ throughout the tournament.

\subsection{Objective Function}
The model's objective is to minimize the maximum absolute difference between the number of home and away games played by any team. This maximum difference is quantified by the integer variable $D \in [1, \dots, N-1]$, which was previously referred to as $\text{max\_imbalance}$. We first find, for each team, the number of games played at home (2), and then constrain D as being greater or equal than the difference of home and away games for each team. Given that we have a minimization problem, this is effectively equivalent to computing the max: 
$$\begin{cases}
    \min d \\
    d = \max_t |home_t - away_t|
\end{cases} = \begin{cases}
    \min d \\
    d \geq |home_t - away_t| \ \forall t \in T
\end{cases}$$The absolute value of the difference is not computed explicitly but is decomposed into 2 inequalities (3)(4). Finally, we look for the minimum of D (1).

\begin{align}
    \min \ &D \\
    H_t =& \sum_{w \in W, m \in M} \mathbbm{1}[flip\_slot_{w,p} = 0 \land rb_{m,w,0} = t] \notag \\
    +& \sum_{w \in W, m \in M} \mathbbm{1}[flip\_slot_{w,p} = 1 \land rb_{m, w,1} = t] \hspace{20px}  && \forall t \in T\\
    D &\geq 2H_t - (N-1) && \forall t \in T\\
    D & \geq -(2 H_t - (N-1)) && \forall t \in T
\end{align}

\subsection{Constraints}
\subsubsection{Each match is assigned to a unique period each week}
Due to how the decision variables are defined, it was necessary to impose that each period in each week is assigned a single match (5) and each match is assigned to a single period (6).

\begin{align}
    \sum_{m \in M} match\_schedule_{w,p,m} &= 1 \hspace{20px} \forall p \in P \hspace{10px} \forall w \in W\\
    \sum_{p \in P} match\_schedule_{w,p,m} &= 1 \hspace{20px} \forall m \in M \hspace{10px}\forall w \in W
\end{align}

\subsubsection{Each team plays at most twice in the same period}
The constraint on teams playing at most twice in the same period is imposed by first linking the variables of $match\_schedule$ to those in TP based on the values in $rb$ (7) and then limiting the sum of periods of play to being smaller or equal than 2 (8). 

\begin{align}
    TP_{t,w,p} &= match\_schedule_{w,p,m} \hspace{20px} \text{where}\ t \in rb_{m, w} \hspace{20px} \forall t \forall p  \forall w\\
    \sum_{w \in W} &TP_{t,w,p} \leq 2 \hspace{40px} \forall t \in T \hspace{10px} \forall p \in P
\end{align}

\subsection{Validation}
\subsubsection*{Experimental design}
The model is written in Python by making use of the PuLP library. The solvers tested on the model were: CBC 2.10.3, HiGHS 1.10.0, CPLEX 22.1.1 and SCIP 5.5.0, all used with their default parameters. The time elapsed to find an optimal solution, within the 300 second time limit, was measured for each solver up to N=24. All tests were run on a single core of an Intel i7-10750H CPU.

\subsubsection*{Experimental results}
As shown in Table \ref{table:mip-results}, CBC had the worst performance, it isn't able to find the optimal solution for n greater than 14. CPLEX, instead, is the fastest up to N=14 but after N=16 it stops finding a solution. HiGHS was able to find an optimal schedule up to N=18 and SCIP, the best performer of the four, was able to reach N=20.

\begin{table}[htbp]
\centering
\small
{%
\begin{tabular}{|c|c|c|c|c|}
\toprule
\textbf{N} & \textbf{CBC} &\textbf{HiGHS} & \textbf{CPLEX} & \textbf{SCIP} \\
\midrule
6 & 0 & 0 & 0 & 0 \\
8 & 0 & 0 & 0 & 0 \\
10 & 1 & 0 & 0 & 0 \\
12 & 2 & 1 & 0 & 5 \\
14 & 45 & 12 & 5 & 17\\
16 & N/A & 62 & 20 & 15\\
18 & N/A & 218 & N/A & 192\\
20 & N/A & N/A & N/A & 101\\
22 & N/A & N/A & N/A & N/A\\
\bottomrule
\end{tabular}
}
\caption{MIP optimization solver results}
\label{table:mip-results}
\end{table}

It was also verified that the solvers either find an optimal solution or no solution at all within the time limit.